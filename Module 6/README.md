# Challenge: MySQL Aggregate Queries

<div class="user_content enhanced" data-test-id="assignments-2-assignment-toggle-details-text"><h1 class="code-line" data-line-start="0" data-line-end="1">Aggregate Queries in MySQL</h1>
<h2 class="code-line" data-line-start="2" data-line-end="3"><a id="Goals_2"></a>Goals</h2>
<ul>
<li class="has-line-data" data-line-start="4" data-line-end="5">To gain experience and develop skill writing advanced queries in MySQL using the aggregate functions.</li>
<li class="has-line-data" data-line-start="5" data-line-end="6">To continue developing an understand of primary keys and foreign keys, and the relationships between tables in a MySQL database.</li>
<li class="has-line-data" data-line-start="6" data-line-end="8">To continue developing the skill to logically solve more complex queries in MySQL</li>
</ul>
<h2 class="code-line" data-line-start="8" data-line-end="9"><a id="Description_8"></a>Description</h2>
<p class="has-line-data" data-line-start="10" data-line-end="11">In this challenge you will begin working with a new database called classicmodels to develop more complex sql queries using aggregate functions and referencing multiple tables.</p>
<h2 class="code-line" data-line-start="12" data-line-end="13"><a id="Purpose_12"></a>Purpose</h2>
<p class="has-line-data" data-line-start="14" data-line-end="15">This challenge will provide experience with generating computed values from data stored in our database using aggregate functions in MySQL.</p>
<h2 class="code-line" data-line-start="16" data-line-end="17"><a id="Project_Tasks_16"></a>Project Tasks</h2>
<ol>
<li class="has-line-data" data-line-start="18" data-line-end="19"><span class="instructure_file_holder link_holder instructure_file_link_holder"><a class="" title="classicmodels.zip" href="https://umsystem.instructure.com/courses/137455/files/12898655?wrap=1" target="_blank" data-api-endpoint="https://umsystem.instructure.com/api/v1/courses/137455/files/12898655" data-api-returntype="File">Download the Classic Models database and schema</a><a class="file_download_btn" role="button" download="" style="margin-inline-start: 5px; text-decoration: none;" href="https://umsystem.instructure.com/courses/137455/files/12898655/download?download_frd=1"><span role="presentation"><svg viewBox="0 0 1920 1920" version="1.1" xmlns="http://www.w3.org/2000/svg" style="width:1em; height:1em; vertical-align:middle; fill:currentColor">
    <path d="M1807.09271,1482.47718 L1886.82918,1562.43953 L1531.51624,1917.75247 L355.346824,1917.75247 L0.0338823529,1562.43953 L79.8832941,1482.47718 L402.104471,1804.81129 L1484.75859,1804.81129 L1807.09271,1482.47718 Z M997.677176,-0.0338823529 L997.677176,1166.98729 L1352.99012,811.674353 L1432.95247,891.523765 L941.093647,1383.15671 L449.460706,891.523765 L529.423059,811.674353 L884.736,1166.98729 L884.736,-0.0338823529 L997.677176,-0.0338823529 Z" stroke="none" stroke-width="1" fill-rule="evenodd"></path>
</svg>
</span><span class="screenreader-only">Download Download the Classic Models database and schema</span></a></span>. Copy the sql file into Docker from your local file system.</li>
<li class="has-line-data" data-line-start="19" data-line-end="20">Log into the MySQL server in the mysql-container in your docker environment.</li>
<li class="has-line-data" data-line-start="20" data-line-end="21">Load the Database and explore basic SQL commands.</li>
<li class="has-line-data" data-line-start="21" data-line-end="22">Construct queries to answer the questions about the database and save queries to an sql file.</li>
<li class="has-line-data" data-line-start="22" data-line-end="24">Submit sql file to Canvas</li>
</ol>
<h2 class="code-line" data-line-start="24" data-line-end="25"><a id="1_Copy_SQL_file_into_Docker_Container_24"></a>1. Copy SQL file into Docker Container</h2>
<ol>
<li class="has-line-data" data-line-start="26" data-line-end="27">Save the classicmodels.sql file in the sql folder inside of the Docker folder you created in module 1.</li>
<li class="has-line-data" data-line-start="27" data-line-end="28">Open your terminal (mac) or command prompt (PC) and navigate to the Docker -&gt; sql folder you just created.</li>
<li class="has-line-data" data-line-start="28" data-line-end="31">You can now copy the classicmodels.sql file into the sql-files folder in your mysql-container in the Docker environment using the docker copy command.
<ul>
<li class="has-line-data" data-line-start="29" data-line-end="31"><code>docker cp classicmodels.sql mysql-container:/root/sql-files</code></li>
</ul>
</li>
</ol>
<h2 class="code-line" data-line-start="31" data-line-end="32"><a id="2_Log_into_the_MySQL_Server_31"></a>2. Log into the MySQL Server</h2>
<p class="has-line-data" data-line-start="33" data-line-end="34">Next, you will have to log into the sql-container to login into the MySQL server. And before you log in you will check to ensure the copy you performed in the previous step was successful.</p>
<ol>
<li class="has-line-data" data-line-start="35" data-line-end="36">Open your terminal (mac) or command prompt (PC) and type the following commands:</li>
<li class="has-line-data" data-line-start="36" data-line-end="38">Log into the server root of the mysql-container.
<ul>
<li class="has-line-data" data-line-start="37" data-line-end="38"><code>docker exec -it mysql-container bash</code></li>
</ul>
</li>
<li class="has-line-data" data-line-start="38" data-line-end="40">Change directory to the sql-files directory.
<ul>
<li class="has-line-data" data-line-start="39" data-line-end="40"><code>cd ~/sql-files/</code></li>
</ul>
</li>
<li class="has-line-data" data-line-start="40" data-line-end="42">Check to ensure the classicmodels.sql file was copied to the directory. After you type the following command you should see the classicmodels.sql file listed.
<ul>
<li class="has-line-data" data-line-start="41" data-line-end="42"><code>ls</code></li>
</ul>
</li>
<li class="has-line-data" data-line-start="42" data-line-end="47">Login to the MySQL server from the sql-files directory with username root and password “root” by typing the following
<ul>
<li class="has-line-data" data-line-start="43" data-line-end="44"><code>mysql -u root -p</code></li>
<li class="has-line-data" data-line-start="44" data-line-end="47">When the password appears, enter the password
<ul>
<li class="has-line-data" data-line-start="45" data-line-end="47"><code>root</code></li>
</ul>
</li>
</ul>
</li>
</ol>
<p class="has-line-data" data-line-start="47" data-line-end="48">You will now be logged into the mysql server.</p>
<h2 class="code-line" data-line-start="49" data-line-end="50"><a id="3_Load_the_Database_49"></a>3. Load the Database</h2>
<p class="has-line-data" data-line-start="51" data-line-end="52">You will now tell the MySQL server to load the classicmodels database from the classicmodels.sql file. While logged into the mysql server type the following command.</p>
<ul>
<li class="has-line-data" data-line-start="53" data-line-end="55"><code>source ~/sql-files/classicmodels.sql</code></li>
</ul>
<p class="has-line-data" data-line-start="55" data-line-end="56"><strong><em>This command looks different from the source command we used in previous modules because this uses an absolute path reference instead of a relative path reference.</em></strong></p>
<p class="has-line-data" data-line-start="57" data-line-end="58">You should see a number of messages like this “Query OK, 100 rows affected (0.00 sec)”. This means that MySQL successfully loaded the database and you can now exlore the database with the following commands.</p>
<ol>
<li class="has-line-data" data-line-start="59" data-line-end="61">View the databases that are currently on the MySQL server. There is more than the one you just created
<ul>
<li class="has-line-data" data-line-start="60" data-line-end="61"><code>SHOW databases;</code></li>
</ul>
</li>
<li class="has-line-data" data-line-start="61" data-line-end="63">Select the database you want to query. We want to use the module2 database. Type
<ul>
<li class="has-line-data" data-line-start="62" data-line-end="63"><code>USE classicmodels;</code></li>
</ul>
</li>
<li class="has-line-data" data-line-start="63" data-line-end="65">Show the database tables that are in the modules Database.
<ul>
<li class="has-line-data" data-line-start="64" data-line-end="65"><code>SHOW tables;</code></li>
</ul>
</li>
<li class="has-line-data" data-line-start="65" data-line-end="69">Look a the columns (fields) and their data types in a table. Let’s try the customer table.
<ul>
<li class="has-line-data" data-line-start="66" data-line-end="67"><code>DESCRIBE orders;</code></li>
<li class="has-line-data" data-line-start="67" data-line-end="69">Now try it with the other tables.</li>
</ul>
</li>
</ol>
<h2 class="code-line" data-line-start="69" data-line-end="70"><a id="4_Construct_Queries_69"></a>4. Construct Queries</h2>
<p class="has-line-data" data-line-start="71" data-line-end="72">Now that we have our database loaded we can develop queries to access and manipulate the data in the database. You should write queries for the following questions. Save all of your queries in a file names mod6_queries_[pawprint].sql. An sql file is just a text file with a “.sql” extension so it can be created in any text editor.</p>
<ol>
<li class="has-line-data" data-line-start="73" data-line-end="74">Calculate the number of orders for each product that has been ordered. Display the product name and number of orders in a column called “Number of Orders”. Display the results in descending order based on “Number of Orders”. Note: You are calculating the number of orders and not quantity ordered. For example, if Alice orders 3 pizzas today and 5 pizzas next week then pizza orders equals 2 and the quantity of pizzas ordered equals 8. <strong>109 rows returned.</strong></li>
<li class="has-line-data" data-line-start="74" data-line-end="75">Calculate the total number of each product that has been ordered. Display the product name and quantity ordered in a column called “Quantity Ordered”. Display the results in descending order based on Quantity Ordered. <strong>109 rows returned.</strong></li>
<li class="has-line-data" data-line-start="75" data-line-end="76">Calculate the total dollar value of the top 25 products that has been ordered in the database. Display the product name and the dollar value in a column called “Total Value”.
<ol>
<li class="has-line-data" data-line-start="75" data-line-end="76">+--------------------------------------+----------------------+<br>| productName &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; | Total Value |<br>+-----------------------------------------------+-------------+<br>| 1992 Ferrari 360 Spider red &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; | &nbsp; 276839.98 |<br>| 2001 Ferrari Enzo &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; 190755.86 |<br>| 1952 Alpine Renault 1300 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; 190017.96 |<br>| 2003 Harley-Davidson Eagle Drag Bike | &nbsp; 170686.00 |<br>| 1968 Ford Mustang &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; | &nbsp; 161531.48 |<br>| 1969 Ford Falcon &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; 152543.02 |<br>| 1980s Black Hawk Helicopter &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; 144959.91 |<br>| 1998 Chrysler Plymouth Prowler &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; | &nbsp; 142530.63 |<br>| 1917 Grand Touring Sedan &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; | &nbsp; 140535.60 |<br>| 2002 Suzuki XREO &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; | &nbsp; 135767.03 |<br>| 1956 Porsche 356A Coupe &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp; | &nbsp; 134240.71 |<br>| 1969 Corvair Monza &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; | &nbsp; 132363.79 |<br>| 1928 Mercedes-Benz SSK &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; 132275.98 |<br>| 1957 Corvette Convertible &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; | &nbsp; 130749.31 |<br>| 1972 Alfa Romeo GTA &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; 127924.32 |<br>| 1962 LanciaA Delta 16V &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; | &nbsp; 123123.01 |<br>| 1970 Triumph Spitfire &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; 122254.75 |<br>| 1976 Ford Gran Torino &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; | &nbsp; 121890.60 |<br>| 1948 Porsche Type 356 Roadster &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; | &nbsp; 121653.46 |<br>| 1958 Setra Bus &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; 119085.25 |<br>| 1995 Honda Civic &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; 119050.95 |<br>| 1962 Volkswagen Microbus &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; 118774.33 |<br>| 1964 Mercedes Tour Bus &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; 117669.66 |<br>| 1993 Mazda RX-7 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; | &nbsp; 114648.12 |<br>| 1940s Ford truck &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; | &nbsp; 114232.79 |<br>+--------------------------------------------------+-------------+</li>
</ol>
</li>
<li class="has-line-data" data-line-start="76" data-line-end="77">Calculate the number of orders each customer has placed and display the top 25 in descending order based on orders placed. Display the customer name and the orders placed in a columns called “Orders Placed”.
<ol>
<li class="has-line-data" data-line-start="76" data-line-end="77">+--------------------------------+-----------+<br>| customerName &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | NumOrders |<br>+--------------------------------+-----------+<br>| Euro+ Shopping Channel &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp;26 |<br>| Mini Gifts Distributors Ltd.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | &nbsp; &nbsp; &nbsp; &nbsp;17 |<br>| Down Under Souveniers, Inc &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; 5 |<br>| Australian Collectors, Co. &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; 5 |<br>| Reims Collectables &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; 5 |<br>| Danish Wholesale Imports &nbsp; &nbsp; &nbsp;&nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; 5 |<br>| Dragon Souveniers, Ltd. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; 5 |<br>| Kelly's Gift Shop &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; 4 |<br>| Souveniers And Things Co. &nbsp; &nbsp; &nbsp;&nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; 4 |<br>| Anna's Decorations, Ltd &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; 4 |<br>| Salzburg Collectables &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; 4 |<br>| The Sharp Gifts Warehouse &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; 4 |<br>| Tokyo Collectables, Ltd &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; 4 |<br>| Handji Gifts&amp; Co &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; 4 |<br>| Technics Stores Inc. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; 4 |<br>| Diecast Classics Inc. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; 4 |<br>| Muscle Machine Inc &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; 4 |<br>| Royale Belge &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; 4 |<br>| Volvo Model Replicas, Co &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; 4 |<br>| Land of Toys Inc. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; 4 |<br>| Blauer See Auto, Co. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; 4 |<br>| Baane Mini Imports &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; 4 |<br>| La Rochelle Gifts &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; 4 |<br>| Corporate Gift Ideas Co. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; 4 |<br>| Mini Wheels Co. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; 3 |<br>+------------------------------+----------------+</li>
</ol>
</li>
<li class="has-line-data" data-line-start="77" data-line-end="78">Calculate the total payments made each year. Display the year and total payments in a column called “Total Payments”. <strong><em>Note: you will have to use the YEAR() function to get the year portion of the payment date.</em></strong>
<ol>
<li class="has-line-data" data-line-start="77" data-line-end="78"><strong><em>+----------------+------+<br>| Total Payments | Year |<br>+----------------+------+<br>| &nbsp; &nbsp; 4313328.25 | 2004 |<br>| &nbsp; &nbsp; 3250217.70 | 2003 |<br>| &nbsp; &nbsp; 1290293.28 | 2005 |<br>+----------------+------+</em></strong></li>
</ol>
</li>
<li class="has-line-data" data-line-start="78" data-line-end="79">Calculate the total payments made each month in 2004. Display the month and total payments in a column called “Total Payments”. Order the results by month in ascending order. <strong><em>Note: you will have to use the MONTH() and YEAR() functions.</em></strong>
<ol>
<li class="has-line-data" data-line-start="78" data-line-end="79"><strong><em>+-----------+-------+<br>| Payment &nbsp; | Month |<br>+-----------+-------+<br>| 234152.13 | &nbsp; &nbsp; 1 |<br>| 106652.01 | &nbsp; &nbsp; 2 |<br>| 404603.21 | &nbsp; &nbsp; 3 |<br>| 173245.96 | &nbsp; &nbsp; 4 |<br>| 208524.42 | &nbsp; &nbsp; 5 |<br>| 185842.86 | &nbsp; &nbsp; 6 |<br>| 284191.48 | &nbsp; &nbsp; 7 |<br>| 378094.30 | &nbsp; &nbsp; 8 |<br>| 476445.53 | &nbsp; &nbsp; 9 |<br>| 185103.43 | &nbsp; &nbsp;10 |<br>| 857187.30 | &nbsp; &nbsp;11 |<br>| 819285.62 | &nbsp; &nbsp;12 |<br>+-----------+-------+</em></strong></li>
</ol>
</li>
<li class="has-line-data" data-line-start="79" data-line-end="80">Calculate the total payments made each day in December of 2004. Display the day in a column named “Day” and total payments in a column called “Total Payments”. Order the results by day in ascending order. <strong><em>Note: you will have to use the MONTH(), DAY(), and YEAR() functions.</em></strong>
<ol>
<li class="has-line-data" data-line-start="79" data-line-end="80"><strong><em>+----------------+-- -------+<br>| Payment Amount&nbsp;&nbsp; | Day &nbsp;|<br>+----------------+---------+<br>| &nbsp; &nbsp; &nbsp; 20564.86&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | &nbsp; &nbsp;1 |<br>| &nbsp; &nbsp; &nbsp; 50025.35 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp;2 |<br>| &nbsp; &nbsp; &nbsp; 12081.52 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp;3 |<br>| &nbsp; &nbsp; &nbsp; 51209.58 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp;4 |<br>| &nbsp; &nbsp; &nbsp; 37654.09 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp;5 |<br>| &nbsp; &nbsp; &nbsp; 34603.95 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp;6 |<br>| &nbsp; &nbsp; &nbsp; 25505.98 &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; | &nbsp; &nbsp;7 |<br>| &nbsp; &nbsp; &nbsp; 73407.89 &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; | &nbsp; &nbsp;8 |<br>| &nbsp; &nbsp; &nbsp; 18888.31&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | &nbsp; 11 |<br>| &nbsp; &nbsp; &nbsp; 36005.71 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; 12 |<br>| &nbsp; &nbsp; &nbsp; 13671.82 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; 13 |<br>| &nbsp; &nbsp; &nbsp; 39964.63&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | &nbsp; 14 |<br>| &nbsp; &nbsp; &nbsp; 82261.22&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | &nbsp; 15 |<br>| &nbsp; &nbsp; &nbsp; 40495.25&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | &nbsp; 17 |<br>| &nbsp; &nbsp; &nbsp; &nbsp;1676.14 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; 18 |<br>| &nbsp; &nbsp; &nbsp; 39440.59&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | &nbsp; 24 |<br>| &nbsp; &nbsp; &nbsp; 47142.70 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; 27 |<br>| &nbsp; &nbsp; &nbsp; 26311.63 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; | &nbsp; 30 |<br>| &nbsp; &nbsp; &nbsp;168374.40 &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; | &nbsp; 31 |<br>+-----------------------+-------+</em></strong></li>
</ol>
</li>
<li class="has-line-data" data-line-start="80" data-line-end="81">Calculate the total payments made by each customer in the database who has made a payment. Display the customer name and the total payments in a column named “Total Payments”. Order the results by total payments. <strong>98 rows returned. The results below show the first 5 and last 5 results.</strong><br>
<ol>
<li class="has-line-data" data-line-start="80" data-line-end="81">+------------------------------------+----------------+<br>| customerName &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | Total Payments |<br>+------------------------------------+----------------+<br>| Euro+ Shopping Channel &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp;715738.98 |<br>| Mini Gifts Distributors Ltd. &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp;584188.24 |<br>| Australian Collectors, Co. &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp;180585.07 |<br>| Muscle Machine Inc &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp;177913.95 |<br>| Dragon Souveniers, Ltd. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| &nbsp; &nbsp; &nbsp;156251.03 |<br>......<br>| Royale Belge &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; 29217.18 |<br>| Frau da Collezione &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; 25358.32 |<br>| Atelier graphique &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| &nbsp; &nbsp; &nbsp; 22314.36 |<br>| Auto-Moto Classics Inc. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| &nbsp; &nbsp; &nbsp; 21554.26 |<br>| Boards &amp; Toys Co. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| &nbsp; &nbsp; &nbsp; &nbsp;7918.60 |<br>+------------------------------------+----------------+</li>
</ol>
</li>
<li class="has-line-data" data-line-start="81" data-line-end="82">Calculate and display the number of customers in each state. Display the state name and and number of customers in each state in a column called “Number of Customers in State”. Sort the results by the Number of Customers in State.
<ol>
<li class="has-line-data" data-line-start="81" data-line-end="82">+---------------+------------------------+<br>| state &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | Num Customers in State |<br>+---------------+------------------------+<br>| CA &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 11 |<br>| MA &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;9 |<br>| NY &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;6 |<br>| CT &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4 |<br>| PA &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3 |<br>| Victoria &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2 |<br>| BC &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2 |<br>| NSW &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2 |<br>| Tokyo &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 |<br>| NH &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 |<br>| Pretoria &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 |<br>| Co. Cork &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 |<br>| Queensland &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 |<br>| NJ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 |<br>| Isle of Wight&nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 |<br>| Qu?bec &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 |<br>| Osaka &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 |<br>| NV &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 |<br>| NULL &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 |<br>+-------------------+------------------------+</li>
</ol>
</li>
<li class="has-line-data" data-line-start="82" data-line-end="83">Which employees manage the most people? Develop a query to calculate the number of people each employees manages. Display the employee number and number of employees employees they manage in a column called “Number of Reports”. <strong><em>Hint: we know an employee manages another employee if their employee number appears in the reportsTo column in the employee table.</em></strong>
<ol>
<li class="has-line-data" data-line-start="82" data-line-end="83"><strong><em>+-----------+----------------+<br>| reportsTo | NumReports |<br>+-----------+----------------+<br>| &nbsp; &nbsp; &nbsp;NULL | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 0 |<br>| &nbsp; &nbsp; &nbsp;1002 | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; 2 |<br>| &nbsp; &nbsp; &nbsp;1056 | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 4 |<br>| &nbsp; &nbsp; &nbsp;1088 | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3 |<br>| &nbsp; &nbsp; &nbsp;1102 | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 6 |<br>| &nbsp; &nbsp; &nbsp;1143 | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 6 |<br>| &nbsp; &nbsp; &nbsp;1621 | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 1 |<br>+-----------+----------------+</em></strong></li>
</ol>
</li>
<li class="has-line-data" data-line-start="83" data-line-end="84">Write a query to calculate the number of product lines in the database. Display the result in a column called “Number of Lines”.
<ol>
<li class="has-line-data" data-line-start="83" data-line-end="84">+------------------------------+<br>| Number of Product Lines |<br>+-------------------------------+<br>| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 7 |<br>+-------------------------------+</li>
</ol>
</li>
<li class="has-line-data" data-line-start="84" data-line-end="86">Calculate the dollar value of each product in inventory. You can calculate this by multiplying the quantity in stock by the buy price. Display the product name, quantity in stock, buy price, and in its dollar value in a column called “Dollar Value”. Sort the results in descending order based on dollar value. <strong>110 rows returned. The results below show the first 5 and last 5 results.</strong><br>
<ol>
<li class="has-line-data" data-line-start="84" data-line-end="86">+---------------------------------------------+-----------------+----------+--------------+<br>| productName &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; | quantityInStock | buyPrice | Dollar Value |<br>+---------------------------------------------+-----------------+----------+--------------+<br>| 1995 Honda Civic &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;9772 | &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 93.89 | &nbsp; &nbsp;917493.08 |<br>| 1952 Alpine Renault 1300 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;7305 | &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 98.58 | &nbsp; &nbsp;720126.90 |<br>| 1962 LanciaA Delta 16V &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;6791 | &nbsp; &nbsp; &nbsp;&nbsp; 103.42 | &nbsp; &nbsp;702325.22 |<br>| 1968 Dodge Charger &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;9123 | &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 75.16 | &nbsp; &nbsp;685684.68 |<br>| 1976 Ford Gran Torino &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;9127 | &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 73.49 | &nbsp; &nbsp;670743.23 |<br>.....<br>| Pont Yacht &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 414 | &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 33.30 | &nbsp; &nbsp; 13786.20 |<br>| 1997 BMW F650 ST &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 178 | &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 66.92 | &nbsp; &nbsp; 11911.76 |<br>| 1968 Ford Mustang &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;68 | &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 95.34 | &nbsp; &nbsp; &nbsp;6483.12 |<br>| 1928 Ford Phaeton Deluxe &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp;&nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 136 | &nbsp; &nbsp; &nbsp;&nbsp; 33.02 | &nbsp; &nbsp; &nbsp;4490.72 |<br>| 1960 BSA Gold Star DBD34 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;15 | &nbsp; &nbsp; &nbsp; &nbsp; 37.32 | &nbsp; &nbsp; &nbsp; 559.80 |<br>+---------------------------------------------+-----------------+----------+--------------+</li>
</ol>
</li>
</ol>
<h2 class="code-line" data-line-start="86" data-line-end="87"><a id="5_What_to_Submit_86"></a>5. What to Submit</h2>
<p class="has-line-data" data-line-start="88" data-line-end="89">Submit the <strong>mod6_queries_[pawprint].sql</strong> file with the queries you constructed in the previous step to Canvas.</p></div>
